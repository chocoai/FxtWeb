# -*- coding: utf-8 -*-
import os
import unittest
from time import sleep
import COMMON.DRIVER as DR
import COMMON.ELEMNET as EL
import COMMON.LOG as LG
from BaseCase.GJB import commond
from BaseCase.GJB import unittestBase


from COMMON import CONFIG as CFG
xmlpath=os.path.join(CFG.prjDir,'BaseCase\GJB')
url=CFG.ReadConfig().getConfigValue('Url')

logger=LG.MyLog().get_log().get_myLogger()
class testBase(unittestBase.unittestBase):
    """åŸºæœ¬åŠŸèƒ½"""

    @LG.caseLog(u'å…¶ä»–æ•°æ®å¯¼å‡º037')
    def testShuJuDaoChu037(self):
        commond.DaoChuDetail(self, self.el, 'custom', 'Qita')
        sleep(30)

    def testPrintInquirysheet(self):
        pass
    
    @LG.caseLog(u'XJ_GN015_åˆ é™¤å¤šæ¡æ•°æ®')
    def testMulDelete(self):
        self.muldelete = EL.get_el_name('Shanchu',xmlpath)
        DeList = commond.DeleteDataOperate(self, self.el, self.muldelete, 14, 0)
        sleep(3)
        DataList = commond.data_List(self.el)
        sleep(3)
        self.assertEqual(set(DeList).issubset(set(DataList)), False)

    # æ­¤ç”¨ä¾‹æ— æ³•ä½¿ç”¨è°·æ­Œæµè§ˆå™¨
    @LG.caseLog(u'XJ_GN_027_æ•°æ®å¯¼å‡º')
    def testShuJuDaoChu027(self):
        self.driver.close()
        self.driver = DR.MyDriver.get_driver()
        self.el = EL.Element(self.driver, url, xmlpath)
        commond.DaoChuDetail(self, self.el, 'select')


    @LG.caseLog(u'XJ_GN_019_æ’°å†™é¢„è¯„')
    def testZuanxineYuPing019(self):
        commond.ZuanXieYuPing(self, self.el, 1, u'å¾…å›ä»?)
        commond.DataDetail(self.el, 'dZuanxieyuping', None, 'baogaoleixing')
        sleep(2)


    @LG.caseLog(u'XJ_GN014_åˆ é™¤ä¸€æ¡æ•°æ?)
    def test_XJ_GN014_ADelete(self):
        self.adelete = EL.get_el_name('Shanchu',xmlpath)
        DeList = commond.DeleteDataOperate(self, self.el, self.adelete, 1, 0)
        DataList = commond.data_List(self.el)
        self.assertEqual(set(DeList).issubset(set(DataList)), False)

    @LG.caseLog(u'XJ_GN_022_æ’°å†™é¢„è¯„')
    def testZuanxineYuPing022(self):
        commond.ZuanXieYuPing(self, self.el, 1)
        commond.DataDetail(self.el, 'dZuanxieyuping', u'ç”Ÿæˆé¢„è¯„æŠ¥å‘Š')
        self.driver.switch_to.default_content()
        elDict = self.driver.find_element_by_xpath(
            '/html/body/div[1]/table/tbody/tr[2]/td[2]/div/table/tbody/tr[2]/td[2]/div/font/div').text
        self.assertEqual(elDict, u'æŠ¥å‘Šç±»å‹')

    @LG.caseLog(u'XJ_GN_021_æ’°å†™é¢„è¯„')
    def testZuanxineYuPing021(self):
        commond.ZuanXieYuPing(self, self.el, 1, u'å·²å›ä»?)
        commond.DataDetail(self.el, 'dZuanxieyuping', None, 'baogaoleixing')


    @LG.caseLog(u'XJ_GN_020_æ’°å†™é¢„è¯„')
    def testZuanxineYuPing020(self):
        commond.ZuanXieYuPing(self, self.el, 1, u'å·²å›ä»?)
        commond.DataDetail(self.el, 'dZuanxieyuping', None, 'baogaoleixing')


    @LG.caseLog(u'XJ_GN_004_åŠå…¬')
    def testBanGong(self):
        commond.Duantao(self, self.el,'Bangong')

    @LG.caseLog(u'è½¬ä¸šåŠ?)
    def testZhuanYeWu(self):
        self.zhuanyewu = EL.get_el_name('Zhuanyewu',xmlpath)
        commond.NoDataOperate(self, self.el, self.zhuanyewu)
        self.driver.switch_to.default_content()
        txt = self.driver.find_element_by_xpath(
            '/html/body/div[1]/table/tbody/tr[2]/td[2]/div/table/tbody/tr[2]/td[2]/div/font').text
        self.assertEqual(txt, u'è¯·é€‰æ‹©è¦æ“ä½œçš„é¡?)

    @LG.caseLog(u'å¤åˆ¶æ–°å¢')
    def testFuZhiXinZeng(self):
        """
        ç‚¹å‡»å¤åˆ¶æ–°è€å¢ï¼Œæœªé€‰æ•°æ?
        :return:
        """
        self.fuzhixinzeng = EL.get_el_name('Fuzhixinzeng',xmlpath)
        commond.NoDataOperate(self, self.el, self.fuzhixinzeng)


    @LG.caseLog(u'XJ_GN_013_ç‚¹å‡»åˆ é™¤')
    def testDelete(self):
        self.delete = EL.get_el_name('Shanchu',xmlpath)
        commond.NoDataOperate(self, self.el, self.delete)


    @LG.caseLog(u'XJ_GN_001_å…¨éƒ¨')
    def testQuanBu001(self):
        commond.Duantao(self,self.el,'Quanbu')


    @LG.caseLog(u'XJ_GN_002_ä½å®… ')
    def testZhuZhai(self):
        commond.Duantao(self,self.el,'Zhuzai')
        self.assertEqual('','')

    @LG.caseLog(u'XJ_GN_003_å•†ä¸š')
    def testShangYe(self):
        commond.Duantao(self,self.el,'Shangye')

    @LG.caseLog(u'XJ_GN_005_å·¥ä¸š')
    def testGongye(self):
        commond.Duantao(self,self.el,'Gongye')

    @LG.caseLog(u'XJ_GN_006_åœŸåœ°')
    def testTudi(self):
        commond.Duantao(self,self.el,'Tudi')

    @LG.caseLog(u'XJ_GN_007_èµ„äº§')
    def testZiCan(self):
        commond.Duantao(self,self.el,'Zican')

    @LG.caseLog(u'XJ_GN_008_å…¶ä»–')
    def testQiTa(self):
        commond.Duantao(self,self.el,'Qita')

    @LG.caseLog(u'XJ_GN_010_è‡ªåŠ¨è¯¢ä»·')
    def testZiDongXuJia(self):
        commond.OtherXujia(self,self.el,'Zidongxujia')

    @LG.caseLog(u'XJ_GN_009_å¤šå¥—è¯¢ä»·')
    def testDuoTao(self):
        commond.OtherXujia(self, self.el, 'Duotao')

    @LG.caseLog(u'å¾…ç›–ç«?)
    def testDaiGaiZhang(self):
        self.daigaizhang = EL.get_el_name('Daigaizhang',xmlpath)
        commond.GaiZhang(self, self.el, self.daigaizhang)

    @LG.caseLog(u'å·²ç›–ç«?)
    def testYiGaiZhang(self):
        self.yigaizhang = EL.get_el_name('Yigaizhang',xmlpath)
        commond.GaiZhang(self, self.el, self.yigaizhang)

    @LG.caseLog(u'è½¬ä¸šåŠ?)
    def ZhuanYeWuData(self):
        self.zhuanyewudata = EL.get_el_name('Zhuanyewu',xmlpath)
        commond.ZhuanYeWu(self, self.el, self.zhuanyewudata)
        sleep(1)

    @LG.caseLog(u'æ’°å†™é¢„è¯„017')
    def testZuanXieYuping017(self):
        """
        #ç›´æ¥ç‚¹å‡»æ’°å†™é¢„è¯„ï¼Œæœªé€‰æ‹©æ•°æ®
        #:return:
        """
        self.zuanxieyuping017 = EL.get_el_name('Zuanxieyuping',xmlpath)
        commond.NoDataOperate(self, self.el, self.zuanxieyuping017)



    @LG.caseLog(u'æ’°å†™é¢„è¯„018')
    def testZuanXieYuPing018(self):
        result = commond.ZuanXieYuPing(self, self.el, 2, u'å¾…å›ä»?)
        self.assertTrue(result)
    

if __name__=='__main__':
    unittest.main()





